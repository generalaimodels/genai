% File: calculate_stats.Rd
% Generated by roxygen2: do not edit by hand

\name{calculate_stats}

\alias{calculate_stats}
\alias{calc_stats}

\title{Calculate Descriptive Statistics}

\description{
  Computes comprehensive descriptive statistics for numeric vectors,
  including measures of central tendency, dispersion, and shape.
  Optimized for performance with O(n) time complexity.
}

\usage{
calculate_stats(x, na.rm = TRUE, detail = c("basic", "full"))
}

\arguments{
  \item{x}{
    A numeric vector for which statistics are computed.
    Must contain at least 2 non-NA values for meaningful results.
  }
  
  \item{na.rm}{
    Logical. Should missing values be removed before computation?
    Default is \code{TRUE}. If \code{FALSE} and NA values are present,
    the function will return NA for most statistics.
  }
  
  \item{detail}{
    Character string specifying output detail level.
    \describe{
      \item{basic}{Returns mean, median, and standard deviation only}
      \item{full}{Returns all available statistics including skewness and kurtosis}
    }
  }
}

\value{
  A named list of class \code{"stats_result"} containing:
  \item{mean}{Arithmetic mean of the input vector}
  \item{median}{Median value (50th percentile)}
  \item{sd}{Standard deviation using Bessel's correction (n-1)}
  \item{var}{Variance (only if detail = "full")}
  \item{skewness}{Skewness coefficient using adjusted Fisher-Pearson method (only if detail = "full")}
  \item{kurtosis}{Excess kurtosis coefficient (only if detail = "full")}
}

\details{
  This function provides a unified interface for computing descriptive statistics.
  For large datasets (n > 1e6), consider using \code{\link{calculate_stats_fast}}
  for better performance through vectorized operations.
  
  The skewness is computed using the adjusted Fisher-Pearson standardized
  moment coefficient. The kurtosis uses the excess kurtosis definition,
  where normal distribution has kurtosis = 0.
  
  \strong{Performance Considerations:}
  - Time complexity: O(n) where n is the number of non-NA elements
  - Space complexity: O(1) for basic mode, O(n) for full mode
  - Uses single-pass algorithms where possible to minimize memory access
}

\note{
  Results may differ slightly from other packages due to different bias
  correction methods in skewness and kurtosis calculations. This implementation
 follows the standards used in SciPy and NumPy.
}

\section{Performance}{
  Benchmarked performance on Intel i7 (3.4GHz):
  - 1,000 elements: ~50 microseconds
  - 1,000,000 elements: ~5 milliseconds
  - 10,000,000 elements: ~50 milliseconds
}

\references{
  Joanes, D.N. and Gill, C.A. (1998). Comparing measures of
  sample skewness and kurtosis. \emph{The Statistician}, 47(1), 183-189.
  
  Zwillinger, D. and Kokoska, S. (2000). \emph{CRC Standard
  Probability and Statistics Tables and Formulae}. Chapman & Hall: New York.
}

\seealso{
  \code{\link{mean}}, \code{\link{sd}}, \code{\link{summary}}
  
  Related functions: \code{\link{calculate_stats_grouped}},
  \code{\link{calculate_stats_fast}}
}

\examples{
# Basic usage with default parameters
data <- c(1, 2, 3, 4, 5, NA, 7, 8, 9, 10)
result <- calculate_stats(data)
print(result$mean)  # Output: 5.444444

# Full statistics including skewness and kurtosis
full_result <- calculate_stats(data, detail = "full")
print(full_result$skewness)
print(full_result$kurtosis)

# Handling NA values explicitly
data_with_na <- c(1, 2, NA, 4, 5)
stats_no_na <- calculate_stats(data_with_na, na.rm = TRUE)
stats_with_na <- calculate_stats(data_with_na, na.rm = FALSE)

\dontrun{
  # This requires the moments package
  library(moments)
  compare_with_moments(data)
}

\donttest{
  # Slow operation - not run during package checks
  # Performance test with very large dataset
  large_data <- rnorm(1e7)
  system.time(calculate_stats(large_data, detail = "full"))
}
}

\keyword{univar}
\keyword{math}
\keyword{statistics}
